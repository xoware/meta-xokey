<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Nitrox Software API: General Info</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.2 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul>
</div>
<h1><a class="anchor" name="page1">General Info</a></h1><h2><a class="anchor" name="errorCodes">
Error Codes Info</a></h2>
<div class="fragment"><pre class="fragment">
 * SSL1.x error codes 
 * ------------------
 *
 *  ERR_BAD_RECORD               0x40000002 
 *  There was a MAC miscompare or otherwise a record was found bad on a 
 *  decrypt.
 *  
 *  ERR_BAD_SIZE_OR_DLEN_VAL            0x4000000b
 *  Either the size of the request was bad or the read stream input length
 *  (indicated either by the Dlen value or the scatter/gather list) did not
 *  match the length expected by the request.
 *  
 *  ERR_BAD_PKCS_PAD_OR_LENGTH            0x4000000c
 *  A PKCS#1v15 decrypt found a bad pad value or length
 *
 *  ERR_BAD_PKCS_TYPE               0x4000000e
 *  A PKCS#1v15 decrypt found a bad type.
 *  
 *  ERR_BAD_SCATTER_GATHER_WRITE_LENGTH         0x4000000d
 *  The write stream length indicated by the scatter list did not match the
 *  write stream length of the request.
 *
 *
 * IPsec 1.x error codes
 * ---------------------
 * 
 *  BAD_PACKET_LENGTH               0x40000080
 *  BAD_IPSEC_MODE               0x40000081
 *  BAD_IPSEC_PROTOCOL               0x40000082
 *  BAD_IPSEC_AUTHENTICATION            0x40000083
 *  BAD_IPSEC_PADDING               0x40000084
 *  BAD_IP_VERSION               0x40000085
 *  BAD_IPSEC_AUTH_TYPE               0x40000086
 *  BAD_IPSEC_ENCRYPT_TYPE            0x40000087
 *  BAD_IKE_DH_GROUP               0x40000088
 *  BAD_MODLENGTH               0x40000089
 *  BAD_PKCS_PAD_OR_LENGTH            0x4000008a
 *  BAD_PKCS_TYPE               0x4000008b
 *  BAD_IPSEC_SPI               0x4000008c
 *  BAD_CHECKSUM               0x4000008d
 *  BAD_IPSEC_CONTEXT               0x4000008e
 *
 *
 * MC2 (Microcode 2.x) SSL and IPsec combined error codes
 * ------------------------------------------------------
 *
 * BAD_OPCODE                  0x40000001
 * BAD_RECORD                  0x40000002
 * BAD_SCATTER_GATHER_LIST            0x40000003
 * BAD_ICV_AESGCM              0x4000000c
 * BAD_KEY_LENGTH_AESGCM       0x40000010
 * BAD_SCATTER_GATHER_WRITE_LENGTH         0x4000000d
 * BAD_LENGTH                  0x4000000f 
 * BAD_BOOT_COMPLETION               0x40000011
 * BAD_PACKET_LENGTH               0x40000012
 * BAD_IPSEC_MODE               0x40000013
 * BAD_IPSEC_PROTOCOL               0x40000014
 * BAD_IPSEC_AUTHENTICATION            0x40000015
 * BAD_IPSEC_PADDING               0x40000016
 * BAD_IP_VERSION               0x40000017
 * BAD_AUTH_TYPE               0x40000018
 * BAD_PKCS_DATA               0x4000001b
 * BAD_IPSEC_SPI               0x4000001c
 * BAD_CHECKSUM                  0x4000001d
 * BAD_IPSEC_CONTEXT               0x4000001e
 * BAD_IPSEC_CONTEXT_DIRECTION            0x4000001f
 * BAD_IPSEC_CONTEXT_FLAG_MISMATCH         0x40000020
 * IPCOMP_PAYLOAD               0x40000021
 * BAD_FRAG_OFFSET               0x40000022
 * BAD_SELECTOR_MATCH               0x40000023
 * BAD_AES_TYPE                  0x40000024
 * BAD_FRAGMENT_SIZE               0x40000026
 * BAD_DSA_VERIFY               0x40000027
 * BAD_PUBLIC_KEY               0x40000028
 * BAD_IKE_DH_GROUP               0x4000002b
 *
 * </pre></div><h2><a class="anchor" name="keyMaterial">
Key memory and format</a></h2>
<div class="fragment"><pre class="fragment">
 *
 *  Key memory and format
 *
 * Asymmetric keys can come from three sources:
 *   - the input stream (i.e. the dptr)
 *   - the on-chip (FSK) key memory
 *    - the extended key memory in local DRAM
 *
 * The FSK memory is 8KB and is addressed, read, and
 * written in multiples of 64-bit words
 *
 * The extended key memory in local DRAM can be up to
 * 4MB.
 *
 * The chinese remainder theorem (CRT) is a theorem that
 * allows for faster private key modular exponentiations.
 * This can (conditionally) be used to improve performance.
 *
 * Without CRT, full modular exponentions are performed
 * (up to 2048-bit). The format of the key material is:
 *      modulus   (modlength 64-bit words)
 *       exponent  (modlength 64-bit words)
 *
 * (The operation is result = (input ^ exponent) mod modulus.)
 *
 * With CRT (on private keys), the format of the key material is:
 *      Q        (modlength/2 64-bit words)
 *      Eq       (modlength/2 64-bit words)
 *      P        (modlength/2 64-bit words)
 *      Ep       (modlength/2 64-bit words)
 *      iqmp     (modlength/2 64-bit words)
 *
 * The following are requirements of this key material with CRT:
 *   modulus = Q * P (Q, P are prime factors of modulus, P &gt; Q)
 *   Q, P are 1/2 the length (in bits or words) of the modulus
 *   Eq = exponent mod (Q - 1)
 *   Ep = exponent mod (P - 1)
 *   iqmp = (q ^ -1) mod p = (q ^ (p-2)) mod p
 * Eq and Ep are the precomputed exponents. iqmp is also precomputed.
 *
 * With CRT, the calculation to  get result = (input ^ exponent) mod modulus
 * is:
 *   inputq = input mod Q
 *   inputp = input mod P
 *   Mq = (inputq ^ Eq) mod Q
 *   Mp = (inputp ^ Ep) mod P
 *      temp = Mp - Mq
 *   if(temp &lt; 0)
 *      temp += p
 *   temp = (temp * iqmp) mod p
 *   result = temp * q + Mq  // modular multiplication not necessary since the result is &lt; modulus
 *   
 *
 * #ifndef MC2
 *      The key material should be in integer format. That means that the least-significant 64-bit
 *      word should be the first word and the most-significant word is the last word. 
 *      (Within a word the bytes are still big-endian - the most-significant byte contains the 
 *      most-significant bits, as you might expect.)
 * #endif
 * </pre></div> <hr size="1"><address style="text-align: right;"><small>Generated on Thu Oct 22 16:08:35 2009 for Nitrox Software API by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.2 </small></address>
</body>
</html>
