<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Nitrox Software API: IPSEC APIs</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.2 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul>
</div>
<h1>IPSEC APIs</h1><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">Uint32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IPSEC__OPS.html#ge3cc798b83fc8dfc71cc96e134e29890">Csp1WriteIpsecSa</a> (<a class="el" href="cavium__common_8h.html#ae4647b4e223ddc716af99e24547caa3">n1_request_type</a> request_type, <a class="el" href="cavium__common_8h.html#f58d73483fbfc9e34094614deb253f57">IpsecProto</a> proto, <a class="el" href="cavium__common_8h.html#2256f5bba1c1c69a92b933aa501df470">Version</a> inner_version, <a class="el" href="cavium__common_8h.html#2256f5bba1c1c69a92b933aa501df470">Version</a> outer_version, <a class="el" href="cavium__common_8h.html#6ea69ddd7b2f3bddd3a72e96016aacd8">IpsecMode</a> mode, <a class="el" href="cavium__common_8h.html#224b9163917ac32fc95a60d8c1eec3aa">Direction</a> dir, <a class="el" href="cavium__common_8h.html#a60a00875581c0a73474c33dfd429b6a">EncType</a> cypher, Uint8 *e_key, <a class="el" href="cavium__common_8h.html#b4ef05f591c153bd728a12b9275c9d1b">AuthType</a> auth, Uint8 *a_key, Uint8 template[40], Uint32 spi, Uint8 copy_df, <a class="el" href="cavium__common_8h.html#3b0d7c4204ebe94b271bbcbed72226ff">FragType</a> ft, Uint16 inter_frag_padding, Uint8 udp_encap, Uint64 context_handle, Uint64 next_context_handle, <a class="el" href="struct__Selector.html">Selector</a> *selectors, int res_order, int req_queue, Uint32 *request_id)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">Uint32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IPSEC__OPS.html#g23358ca4f0bbb2e743b3d16d7e405823">Csp1ProcessPacket</a> (Uint16 size, Uint16 param, <a class="el" href="cavium__common_8h.html#224b9163917ac32fc95a60d8c1eec3aa">Direction</a> dir, Uint16 dlen, <a class="el" href="structCsp1ScatterBuffer.html">n1_scatter_buffer</a> *inv, <a class="el" href="structCsp1ScatterBuffer.html">n1_scatter_buffer</a> *outv, int rlen, Uint64 context_handle, int response_order, int req_queue, Uint32 *request_id)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IPSEC__OPS.html#g6234c23e0df0b7365d109e083cf99644">n1_unconfig_device</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">Uint64&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IPSEC__OPS.html#g828b3784c905e6c6d5959971e483feda">n1_alloc_context</a> (void *device)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IPSEC__OPS.html#g48e5edfcbfc55ef0b2d3b0100bffec14">n1_free_context</a> (void *device, Uint64 ctx)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IPSEC__OPS.html#g672fcc76801279621a76bf598f7ec988">n1_config_device</a> (Uint32 mc)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">Uint32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IPSEC__OPS.html#ga768b641615639c05d981c92022fb1c5">n1_process_inbound_packet</a> (void *device, Uint16 size, Uint16 param, Uint16 dlen, <a class="el" href="structCsp1ScatterBuffer.html">n1_scatter_buffer</a> *in_buff, <a class="el" href="structCsp1ScatterBuffer.html">n1_scatter_buffer</a> *out_buff, int rlen, Uint64 ctx, CallBackFn cb, void *cb_data, int response_order, int req_queue)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">Uint32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IPSEC__OPS.html#gb192e17f54ef4d19180963d50868f2f2">n1_process_outbound_packet</a> (void *device, Uint16 size, Uint16 param, Uint16 dlen, <a class="el" href="structCsp1ScatterBuffer.html">n1_scatter_buffer</a> *in_buff, <a class="el" href="structCsp1ScatterBuffer.html">n1_scatter_buffer</a> *out_buff, int rlen, Uint64 ctx, CallBackFn cb, void *cb_data, int response_order, int req_queue)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">Uint32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IPSEC__OPS.html#gf214b3222ce385a7e6eb866f319f1793">n1_write_ipsec_sa</a> (void *device, <a class="el" href="cavium__common_8h.html#f58d73483fbfc9e34094614deb253f57">IpsecProto</a> proto, <a class="el" href="cavium__common_8h.html#2256f5bba1c1c69a92b933aa501df470">Version</a> inner_version, <a class="el" href="cavium__common_8h.html#2256f5bba1c1c69a92b933aa501df470">Version</a> outer_version, <a class="el" href="cavium__common_8h.html#6ea69ddd7b2f3bddd3a72e96016aacd8">IpsecMode</a> mode, <a class="el" href="cavium__common_8h.html#224b9163917ac32fc95a60d8c1eec3aa">Direction</a> dir, <a class="el" href="cavium__common_8h.html#a60a00875581c0a73474c33dfd429b6a">EncType</a> cypher, Uint8 *e_key, <a class="el" href="cavium__common_8h.html#b4ef05f591c153bd728a12b9275c9d1b">AuthType</a> auth, Uint8 *a_key, Uint8 template[40], Uint32 spi, Uint8 copy_df, Uint8 udp_encap, Uint64 ctx, Uint64 next_ctx, Uint32 *in_buffer, Uint32 *out_buffer, CallBackFn cb, void *cb_data, int res_order, int req_queue)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">Uint32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__IPSEC__OPS.html#ga39effa2324b929d58e1da2d66185b3e">n1_invalidate_ipsec_sa</a> (void *device, Uint64 ctx, Uint32 *in_buffer, Uint32 *out_buffer, CallBackFn cb, void *cb_data, int res_order, int req_queue)</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="g23358ca4f0bbb2e743b3d16d7e405823"></a><!-- doxytag: member="cavium_common.h::Csp1ProcessPacket" ref="g23358ca4f0bbb2e743b3d16d7e405823" args="(Uint16 size, Uint16 param, Direction dir, Uint16 dlen, n1_scatter_buffer *inv, n1_scatter_buffer *outv, int rlen, Uint64 context_handle, int response_order, int req_queue, Uint32 *request_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Uint32 Csp1ProcessPacket           </td>
          <td>(</td>
          <td class="paramtype">Uint16&nbsp;</td>
          <td class="paramname"> <em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Uint16&nbsp;</td>
          <td class="paramname"> <em>param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cavium__common_8h.html#224b9163917ac32fc95a60d8c1eec3aa">Direction</a>&nbsp;</td>
          <td class="paramname"> <em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Uint16&nbsp;</td>
          <td class="paramname"> <em>dlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structCsp1ScatterBuffer.html">n1_scatter_buffer</a> *&nbsp;</td>
          <td class="paramname"> <em>inv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structCsp1ScatterBuffer.html">n1_scatter_buffer</a> *&nbsp;</td>
          <td class="paramname"> <em>outv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>rlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Uint64&nbsp;</td>
          <td class="paramname"> <em>context_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>response_order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>req_queue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Uint32 *&nbsp;</td>
          <td class="paramname"> <em>request_id</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Csp1ProcessPacket<p>
Process inbound and outbound packets in userspace.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>size</em>&nbsp;</td><td>Param1 field as defined in the Microcode Spec. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>param</em>&nbsp;</td><td>Param2 field as defined in the Microcode Spec. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dir</em>&nbsp;</td><td>Direction (INBOUND or OUTBOUND) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dlen</em>&nbsp;</td><td>length of input (packet) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>inv</em>&nbsp;</td><td>pointer to input data (packet to be processed) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>outv</em>&nbsp;</td><td>pointer to output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rlen</em>&nbsp;</td><td>length of output buffer (processed packet) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>context_handle</em>&nbsp;</td><td>64-bit context handle pointer (context_handle%8=0) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>response_order</em>&nbsp;</td><td>Response order (CAVIUM_RESPONSE_ORDERED or CAVIUM_RESPONSE_UNORDERED). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>req_queue</em>&nbsp;</td><td>Queue on which this request has to be sent. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>request_id</em>&nbsp;</td><td>Unique ID for this request.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>SUCCESS</em>&nbsp;</td><td>0 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>FAILURE/PENDING</em>&nbsp;</td><td><a class="el" href="cavium__common_8h.html#c365ddbde6917ab12e93d3fc4b07cb31">Csp1ErrorCodes</a> </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="ge3cc798b83fc8dfc71cc96e134e29890"></a><!-- doxytag: member="cavium_common.h::Csp1WriteIpsecSa" ref="ge3cc798b83fc8dfc71cc96e134e29890" args="(n1_request_type request_type, IpsecProto proto, Version inner_version, Version outer_version, IpsecMode mode, Direction dir, EncType cypher, Uint8 *e_key, AuthType auth, Uint8 *a_key, Uint8 template[40], Uint32 spi, Uint8 copy_df, FragType ft, Uint16 inter_frag_padding, Uint8 udp_encap, Uint64 context_handle, Uint64 next_context_handle, Selector *selectors, int res_order, int req_queue, Uint32 *request_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Uint32 Csp1WriteIpsecSa           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cavium__common_8h.html#ae4647b4e223ddc716af99e24547caa3">n1_request_type</a>&nbsp;</td>
          <td class="paramname"> <em>request_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cavium__common_8h.html#f58d73483fbfc9e34094614deb253f57">IpsecProto</a>&nbsp;</td>
          <td class="paramname"> <em>proto</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cavium__common_8h.html#2256f5bba1c1c69a92b933aa501df470">Version</a>&nbsp;</td>
          <td class="paramname"> <em>inner_version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cavium__common_8h.html#2256f5bba1c1c69a92b933aa501df470">Version</a>&nbsp;</td>
          <td class="paramname"> <em>outer_version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cavium__common_8h.html#6ea69ddd7b2f3bddd3a72e96016aacd8">IpsecMode</a>&nbsp;</td>
          <td class="paramname"> <em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cavium__common_8h.html#224b9163917ac32fc95a60d8c1eec3aa">Direction</a>&nbsp;</td>
          <td class="paramname"> <em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cavium__common_8h.html#a60a00875581c0a73474c33dfd429b6a">EncType</a>&nbsp;</td>
          <td class="paramname"> <em>cypher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Uint8 *&nbsp;</td>
          <td class="paramname"> <em>e_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cavium__common_8h.html#b4ef05f591c153bd728a12b9275c9d1b">AuthType</a>&nbsp;</td>
          <td class="paramname"> <em>auth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Uint8 *&nbsp;</td>
          <td class="paramname"> <em>a_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Uint8&nbsp;</td>
          <td class="paramname"> <em>template</em>[40], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Uint32&nbsp;</td>
          <td class="paramname"> <em>spi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Uint8&nbsp;</td>
          <td class="paramname"> <em>copy_df</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cavium__common_8h.html#3b0d7c4204ebe94b271bbcbed72226ff">FragType</a>&nbsp;</td>
          <td class="paramname"> <em>ft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Uint16&nbsp;</td>
          <td class="paramname"> <em>inter_frag_padding</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Uint8&nbsp;</td>
          <td class="paramname"> <em>udp_encap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Uint64&nbsp;</td>
          <td class="paramname"> <em>context_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Uint64&nbsp;</td>
          <td class="paramname"> <em>next_context_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__Selector.html">Selector</a> *&nbsp;</td>
          <td class="paramname"> <em>selectors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>res_order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>req_queue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Uint32 *&nbsp;</td>
          <td class="paramname"> <em>request_id</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Csp1WriteIpsecSa<p>
Write Ipsec SA data to context memory.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>request_type</em>&nbsp;</td><td>CAVIUM_BLOCKING or CAVIUM_NON_BLOCKING </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>proto</em>&nbsp;</td><td>ESP or AH </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>inner_version</em>&nbsp;</td><td>Protocol version of inner IP header. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>outer_version</em>&nbsp;</td><td>Protocol version of outer IP header. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>mode</em>&nbsp;</td><td>SA mode (TUNNEL or TRANSPORT) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dir</em>&nbsp;</td><td>Direction (INBOUND or OUTBOUND) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cypher</em>&nbsp;</td><td>Encryption algorithm (DESCBC, DES3CBC, AES128CBC, AES192CBC, AES256CBC) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>auth</em>&nbsp;</td><td>Authentication algorithm (MD5HMAC96 or SHA1HMAC96) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>template</em>&nbsp;</td><td>Template for Outer IP header </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>spi</em>&nbsp;</td><td>32 bit SPI value </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>copy_df</em>&nbsp;</td><td>0 (copy the df bit for packet fragments) or 1 (do not copy) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ft</em>&nbsp;</td><td>is fragment type (0 for POST_FRAG and 1 for PRE_FRAG) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>inter_frag_padding</em>&nbsp;</td><td>is the padding size between fragments </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>udp_encap</em>&nbsp;</td><td>0 (no UDP encapsulation) or 1 (UDP encapsulation) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>context_handle</em>&nbsp;</td><td>64-bit context handle pointer (context_handle%8=0) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>next_context_handle</em>&nbsp;</td><td>context handle pointer for next SA. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>selectors</em>&nbsp;</td><td>for selector checking </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>e_key</em>&nbsp;</td><td>Encryption key </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>a_key</em>&nbsp;</td><td>Authentication key </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>res_order</em>&nbsp;</td><td>Response order (CAVIUM_RESPONSE_ORDERED or CAVIUM_RESPONSE_UNORDERED). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>req_queue</em>&nbsp;</td><td>Queue on which this request has to be sent. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>request_id</em>&nbsp;</td><td>Unique ID for this request.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>SUCCESS</em>&nbsp;</td><td>0 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>FAILURE/PENDING</em>&nbsp;</td><td><a class="el" href="cavium__common_8h.html#c365ddbde6917ab12e93d3fc4b07cb31">Csp1ErrorCodes</a> </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="g828b3784c905e6c6d5959971e483feda"></a><!-- doxytag: member="ipsec_mc2.c::n1_alloc_context" ref="g828b3784c905e6c6d5959971e483feda" args="(void *device)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Uint64 n1_alloc_context           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>device</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
n1_alloc_context<p>
Allocates context and returns context handle.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>device</em>&nbsp;</td><td>Pointer to the device to be used (returned in n1_config_device)</td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>SUCCESS</em>&nbsp;</td><td>context handle. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>FAILURE</em>&nbsp;</td><td>0 </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="g672fcc76801279621a76bf598f7ec988"></a><!-- doxytag: member="ipsec_mc2.c::n1_config_device" ref="g672fcc76801279621a76bf598f7ec988" args="(Uint32 mc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* n1_config_device           </td>
          <td>(</td>
          <td class="paramtype">Uint32&nbsp;</td>
          <td class="paramname"> <em>mc</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
n1_config_device<p>
Configures the device and returns list of Cavium devices found in an abstract pointer<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>mc</em>&nbsp;</td><td>Microcode version (MC2 or MC1)</td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>NULL</em>&nbsp;</td><td>Failure </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="g48e5edfcbfc55ef0b2d3b0100bffec14"></a><!-- doxytag: member="ipsec_mc2.c::n1_free_context" ref="g48e5edfcbfc55ef0b2d3b0100bffec14" args="(void *device, Uint64 ctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void n1_free_context           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>device</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Uint64&nbsp;</td>
          <td class="paramname"> <em>ctx</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
n1_free_context<p>
Frees the context handle.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>device</em>&nbsp;</td><td>Pointer to the device to be used (returned in n1_config_device) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ctx</em>&nbsp;</td><td>context handle. </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="ga39effa2324b929d58e1da2d66185b3e"></a><!-- doxytag: member="ipsec_mc2.c::n1_invalidate_ipsec_sa" ref="ga39effa2324b929d58e1da2d66185b3e" args="(void *device, Uint64 ctx, Uint32 *in_buffer, Uint32 *out_buffer, CallBackFn cb, void *cb_data, int res_order, int req_queue)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Uint32 n1_invalidate_ipsec_sa           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>device</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Uint64&nbsp;</td>
          <td class="paramname"> <em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Uint32 *&nbsp;</td>
          <td class="paramname"> <em>in_buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Uint32 *&nbsp;</td>
          <td class="paramname"> <em>out_buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CallBackFn&nbsp;</td>
          <td class="paramname"> <em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>cb_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>res_order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>req_queue</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
n1_invalidate_ipsec_sa<p>
Invalidate IPSec SA<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>device</em>&nbsp;</td><td>Pointer to the device to be used (returned in n1_config_device) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ctx</em>&nbsp;</td><td>context handle. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in_buffer</em>&nbsp;</td><td>Pointer to input buffer (used for SA filling) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>out_buffer</em>&nbsp;</td><td>Pointer to output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cb</em>&nbsp;</td><td>callback function. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cb_data</em>&nbsp;</td><td>callback function argument </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>res_order</em>&nbsp;</td><td>Response order (CAVIUM_RESPONSE_ORDERED or CAVIUM_RESPONSE_UNORDERED). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>req_queue</em>&nbsp;</td><td>Queue on which this request has to be sent.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>SUCCESS</em>&nbsp;</td><td>0 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>FAILURE</em>&nbsp;</td><td>-1 </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="ga768b641615639c05d981c92022fb1c5"></a><!-- doxytag: member="ipsec_mc2.c::n1_process_inbound_packet" ref="ga768b641615639c05d981c92022fb1c5" args="(void *device, Uint16 size, Uint16 param, Uint16 dlen, n1_scatter_buffer *in_buff, n1_scatter_buffer *out_buff, int rlen, Uint64 ctx, CallBackFn cb, void *cb_data, int response_order, int req_queue)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Uint32 n1_process_inbound_packet           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>device</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Uint16&nbsp;</td>
          <td class="paramname"> <em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Uint16&nbsp;</td>
          <td class="paramname"> <em>param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Uint16&nbsp;</td>
          <td class="paramname"> <em>dlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structCsp1ScatterBuffer.html">n1_scatter_buffer</a> *&nbsp;</td>
          <td class="paramname"> <em>inv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structCsp1ScatterBuffer.html">n1_scatter_buffer</a> *&nbsp;</td>
          <td class="paramname"> <em>outv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>rlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Uint64&nbsp;</td>
          <td class="paramname"> <em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CallBackFn&nbsp;</td>
          <td class="paramname"> <em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>cb_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>response_order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>req_queue</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
n1_process_inbound_packet<p>
Processes Inbound IPSec packet -- decrypts the packet with ciphers in the ctx in kernel space.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>device</em>&nbsp;</td><td>Pointer to the device to be used (returned in n1_config_device) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>size</em>&nbsp;</td><td>Param1 field as defined in the Microcode Spec. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>param</em>&nbsp;</td><td>Param2 field as defined in the Microcode Spec. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dlen</em>&nbsp;</td><td>length of input (packet) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>inv</em>&nbsp;</td><td>pointer to input data (packet to be processed) in iovec format </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>outv</em>&nbsp;</td><td>pointer to output buffer in iovec format </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rlen</em>&nbsp;</td><td>Expected length of output. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ctx</em>&nbsp;</td><td>context handle. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cb</em>&nbsp;</td><td>callback function </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cb_data</em>&nbsp;</td><td>callback function argument </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>response_order</em>&nbsp;</td><td>Response order (CAVIUM_RESPONSE_ORDERED or CAVIUM_RESPONSE_UNORDERED). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>req_queue</em>&nbsp;</td><td>Queue on which this request has to be sent.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>SUCCESS</em>&nbsp;</td><td>0 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>FAILURE</em>&nbsp;</td><td>-1 </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="gb192e17f54ef4d19180963d50868f2f2"></a><!-- doxytag: member="ipsec_mc2.c::n1_process_outbound_packet" ref="gb192e17f54ef4d19180963d50868f2f2" args="(void *device, Uint16 size, Uint16 param, Uint16 dlen, n1_scatter_buffer *in_buff, n1_scatter_buffer *out_buff, int rlen, Uint64 ctx, CallBackFn cb, void *cb_data, int response_order, int req_queue)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Uint32 n1_process_outbound_packet           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>device</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Uint16&nbsp;</td>
          <td class="paramname"> <em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Uint16&nbsp;</td>
          <td class="paramname"> <em>param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Uint16&nbsp;</td>
          <td class="paramname"> <em>dlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structCsp1ScatterBuffer.html">n1_scatter_buffer</a> *&nbsp;</td>
          <td class="paramname"> <em>inv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structCsp1ScatterBuffer.html">n1_scatter_buffer</a> *&nbsp;</td>
          <td class="paramname"> <em>outv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>rlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Uint64&nbsp;</td>
          <td class="paramname"> <em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CallBackFn&nbsp;</td>
          <td class="paramname"> <em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>cb_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>response_order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>req_queue</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
n1_process_outbound_packet<p>
Processes Outbound IPSec packet -- encrypts the packet with ciphers in the ctx in kernel space.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>device</em>&nbsp;</td><td>Pointer to the device to be used (returned in n1_config_device). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>size</em>&nbsp;</td><td>Param1 field as defined in the Microcode Spec. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>param</em>&nbsp;</td><td>Param2 field as defined in the Microcode Spec. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dlen</em>&nbsp;</td><td>length of input (packet) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>inv</em>&nbsp;</td><td>pointer to input data (packet to be processed) in iovec format </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>outv</em>&nbsp;</td><td>pointer to output buffer in iovec format </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rlen</em>&nbsp;</td><td>Expected length of output. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ctx</em>&nbsp;</td><td>context handle. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cb</em>&nbsp;</td><td>callback function. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cb_data</em>&nbsp;</td><td>callback function argument </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>response_order</em>&nbsp;</td><td>Response Order (CAVIUM_RESPONSE_ORDERED or CAVIUM_RESPONSE_UNORDERED). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>req_queue</em>&nbsp;</td><td>Queue on which this request has to be sent.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>SUCCESS</em>&nbsp;</td><td>0 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>FAILURE</em>&nbsp;</td><td>-1 </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="g6234c23e0df0b7365d109e083cf99644"></a><!-- doxytag: member="ipsec_mc2.c::n1_unconfig_device" ref="g6234c23e0df0b7365d109e083cf99644" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void n1_unconfig_device           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
n1_unconfig_device<p>
Uncofigures the usage of the device. 
</div>
</div><p>
<a class="anchor" name="gf214b3222ce385a7e6eb866f319f1793"></a><!-- doxytag: member="ipsec_mc2.c::n1_write_ipsec_sa" ref="gf214b3222ce385a7e6eb866f319f1793" args="(void *device, IpsecProto proto, Version inner_version, Version outer_version, IpsecMode mode, Direction dir, EncType cypher, Uint8 *e_key, AuthType auth, Uint8 *a_key, Uint8 template[40], Uint32 spi, Uint8 copy_df, Uint8 udp_encap, Uint64 ctx, Uint64 next_ctx, Uint32 *in_buffer, Uint32 *out_buffer, CallBackFn cb, void *cb_data, int res_order, int req_queue)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Uint32 n1_write_ipsec_sa           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>device</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cavium__common_8h.html#f58d73483fbfc9e34094614deb253f57">IpsecProto</a>&nbsp;</td>
          <td class="paramname"> <em>proto</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cavium__common_8h.html#2256f5bba1c1c69a92b933aa501df470">Version</a>&nbsp;</td>
          <td class="paramname"> <em>inner_version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cavium__common_8h.html#2256f5bba1c1c69a92b933aa501df470">Version</a>&nbsp;</td>
          <td class="paramname"> <em>outer_version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cavium__common_8h.html#6ea69ddd7b2f3bddd3a72e96016aacd8">IpsecMode</a>&nbsp;</td>
          <td class="paramname"> <em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cavium__common_8h.html#224b9163917ac32fc95a60d8c1eec3aa">Direction</a>&nbsp;</td>
          <td class="paramname"> <em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cavium__common_8h.html#a60a00875581c0a73474c33dfd429b6a">EncType</a>&nbsp;</td>
          <td class="paramname"> <em>cypher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Uint8 *&nbsp;</td>
          <td class="paramname"> <em>e_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cavium__common_8h.html#b4ef05f591c153bd728a12b9275c9d1b">AuthType</a>&nbsp;</td>
          <td class="paramname"> <em>auth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Uint8 *&nbsp;</td>
          <td class="paramname"> <em>a_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Uint8&nbsp;</td>
          <td class="paramname"> <em>template</em>[40], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Uint32&nbsp;</td>
          <td class="paramname"> <em>spi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Uint8&nbsp;</td>
          <td class="paramname"> <em>copy_df</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Uint8&nbsp;</td>
          <td class="paramname"> <em>udp_encap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Uint64&nbsp;</td>
          <td class="paramname"> <em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Uint64&nbsp;</td>
          <td class="paramname"> <em>next_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Uint32 *&nbsp;</td>
          <td class="paramname"> <em>in_buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Uint32 *&nbsp;</td>
          <td class="paramname"> <em>out_buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CallBackFn&nbsp;</td>
          <td class="paramname"> <em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>cb_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>res_order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>req_queue</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
n1_write_ipsec_sa<p>
Writes the IPSec SA into the context in kernel space.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>device</em>&nbsp;</td><td>Pointer to the device to be used (returned in n1_config_device) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>proto</em>&nbsp;</td><td>ESP or AH </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>inner_version</em>&nbsp;</td><td>Protocol version of inner IP header. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>outer_version</em>&nbsp;</td><td>Protocol version of outer IP header. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>mode</em>&nbsp;</td><td>SA mode (TUNNEL or TRANSPORT) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dir</em>&nbsp;</td><td>Direction (INBOUND or OUTBOUND) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cypher</em>&nbsp;</td><td>Encryption algorithm (DESCBC, DES3CBC, AES128CBC, AES192CBC, AES256CBC) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>e_key</em>&nbsp;</td><td>Encryption key </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>auth</em>&nbsp;</td><td>Authentication algorithm (MD5HMAC96 or SHA1HMAC96) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>a_key</em>&nbsp;</td><td>Authentication key </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>template</em>&nbsp;</td><td>Template for Outer IP header </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>spi</em>&nbsp;</td><td>32 bit SPI value </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>copy_df</em>&nbsp;</td><td>0 (copy the df bit for packet fragments) or 1 (do not copy) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>udp_encap</em>&nbsp;</td><td>0 (no UDP encapsulation) or 1 (UDP encapsulation) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ctx</em>&nbsp;</td><td>context handle. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>next_ctx</em>&nbsp;</td><td>Next context (In case of bundles) Non-bundles it is NULL </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in_buffer</em>&nbsp;</td><td>Pointer to input buffer (used for SA filling) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>out_buffer</em>&nbsp;</td><td>Pointer to output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cb</em>&nbsp;</td><td>callback function. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cb_data</em>&nbsp;</td><td>callback function argument </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>res_order</em>&nbsp;</td><td>Response order (CAVIUM_RESPONSE_ORDERED or CAVIUM_RESPONSE_UNORDERED). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>req_queue</em>&nbsp;</td><td>Queue on which this request has to be sent.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>SUCCESS</em>&nbsp;</td><td>0 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>FAILURE</em>&nbsp;</td><td>-1 </td></tr>
  </table>
</dl>

</div>
</div><p>
<hr size="1"><address style="text-align: right;"><small>Generated on Thu Oct 22 16:08:36 2009 for Nitrox Software API by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.2 </small></address>
</body>
</html>
